<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<meta id="i18n_pagename" content="index-common">
	    <meta name="keywords" content=""/>
	    <meta name="description" content=""/>
	    <meta http-equiv="Access-Control-Allow-Origin" content="*">
		<link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/libs/font-awesome.css"/>	
		<link rel="stylesheet" href="css/bootstrap-switch.min.css" />
		<!--<link rel="stylesheet" type="text/css" href="css/compiled/theme_styles.css"/>-->
		<link rel="stylesheet" type="text/css" href="css/base.css"/>
		<link rel="stylesheet" href="css/main.css" />
		<link type="image/x-icon" href="favicon.png" rel="shortcut icon"/>
		<script type="text/javascript" src="js/util_gw.js"> </script>
		<SCRIPT language=Javascript src="<% getInfo("lang");%>"></SCRIPT>
		<SCRIPT>
		var wlan_channel=new Array();
		var wlan_txrate=new Array();
		var wlan_channelbound=new Array();
		var wlan_controlsideband=new Array();
		var regDomain=new Array();
		var defaultChan=new Array();
		var lastBand=new Array();
		var lastRegDomain=new Array();
		var RFType=new Array();
		var APMode=new Array();
		var bandIdx=new Array();
		var bandIdxAP=new Array();
		var bandIdxClient=new Array();
		var startChanIdx=new Array();
		var disableSSID=new Array();
		var networkType=new Array();
		var repeater_enable_val=<% getIndex("repeaterEnabled"); %>
		//var multi_AP_Repeater_Str=<% getIndex("multiAPRepeaterStr"); %>
		var countrystr= "<% getInfo("country_str"); %>";
		var wlan_idx= <% getIndex("wlan_idx"); %>;
		var opmode=<% getIndex("opMode"); %>;
		var wispWanId=<% getIndex("wispWanId"); %>;
		var WiFiTest=<% getIndex("WiFiTest"); %>;
		var ssid_2g="<% getIndex("2G_ssid"); %>";
		var ssid_5g="<% getIndex("5G_ssid"); %>";
		var info_country=<% getInfo("info_country");%>;
		var array_country=new Array();
		var info_2g=<% getInfo("info_2g");%>;
		var array_2g=new Array();
		var info_5g=<% getInfo("info_5g");%>;
		var array_5g=new Array();
		
		var is_ulinker="<% getInfo("is_ulinker"); %>"*1;
		var ulinker_opMode="<% getInfo("ulinker_opMode"); %>"*1; //0:AP; 1:Client; 2:Router; 3:RPT
		var wlProfileSupport="<% getInfo("wlProfileSupport"); %>"*1;
		
		lastBand[wlan_idx] = 0;
		lastRegDomain[wlan_idx]= 0;
		bandIdxAP[wlan_idx] = -1;
		bandIdxClient[wlan_idx] = -1;
		startChanIdx[wlan_idx] = 0;
		disableSSID[wlan_idx] = 0;
		networkType[wlan_idx] = <% getIndex("networkType");%>;
		var enc_method=new Array();
		enc_method[wlan_idx] = <%getIndex("encrypt");%>;
		
		// for WPS ---------------------------------------->>
		var wps_disabled=<% getIndex("wscDisable");%>;
		var wps_ssid_old='<% getInfo("ssid"); %>';
		var wps_mode_old=<% getIndex("wlanMode"); %>;
		var wps_config_by_registrar=<% getIndex("wps_by_reg"); %>;
		var wps_encrypt_old=<% getIndex("encrypt");%>;
		var wps_enable1x=<% getIndex("enable1X");%>;
		var wps_wpa_auth=<% getIndex("wpaAuth");%>;
		// <<-------------------------------------- for WPS
		function Data_country(country_code,abb,idx_5g,idx_2g,fullname) 
		{
		        this.country_code= country_code;
		        this.abb = abb;
		        this.idx_5g = idx_5g;
		        this.idx_2g = idx_2g;
		        this.fullname = fullname;
		}
		
		function Data_regdomain(regdomain,channelsetnumber,regdomainarea) 
		{
		        this.regdoemain = regdomain;
		        this.channelsetnumber = channelsetnumber;
		        this.regdomainarea = regdomainarea;
		}
		
		function initData()
		{
			var i=0;
			for(i=0;i<info_country.length;i++)
				array_country[array_country.length++] = new Data_country(info_country[i][0],
				info_country[i][1],info_country[i][2],info_country[i][3],info_country[i][4]);	
			for(i=0;i<info_2g.length;i++)
				array_2g[array_2g.length++] = new Data_regdomain(info_2g[i][0],
				info_2g[i][1],info_2g[i][2]);	
			for(i=0;i<info_5g.length;i++)
				array_5g[array_5g.length++] = new Data_regdomain(info_5g[i][0],
				info_5g[i][1],info_5g[i][2]);	
				
		}
		
		
		
		function Set_SSIDbyBand(form, wlan_id, band, index)
		{
			var selectText=form.elements["band"+wlan_id].options[index].text.substr(0,1);
			var bandOption = form.elements["band"+wlan_id].options.value;
				
			if(bandOption == 0 || bandOption == 1 || (bandOption == 7 && selectText=='2') || bandOption == 2 || bandOption == 9 || bandOption == 10)
			{
				//form.elements["ssid"+wlan_idx].value = ssid_2g;
				var tmpstr=ssid_2g;
				if(ssid_2g.match("&quot;")!=null)
					tmpstr=ssid_2g.replace(/&quot;/g, "\"");
		
				if(ssid_2g.match("&#37;")!=null)
					tmpstr=tmpstr.replace(/&#37;/g, "%");
		
				if(ssid_2g.match("&#38;")!=null)
					tmpstr=tmpstr.replace(/&#38;/g, "&");
		
				if(ssid_2g.match("&#39;")!=null)
					tmpstr=tmpstr.replace(/&#39;/g, "'");
				
				if(ssid_2g.match("&#92;")!=null)
					tmpstr=tmpstr.replace(/&#92;/g, "\\");
		
				if(ssid_2g.match("&#62;")!=null)
					tmpstr=tmpstr.replace(/&#62;/g, ">");
		
				if(ssid_2g.match("&#60;")!=null)
					tmpstr=tmpstr.replace(/&#60;/g, "<");
				
				form.elements["ssid"+wlan_idx].value = tmpstr;
			}
			else if(bandOption == 3 || (bandOption == 7 && selectText=='5') || bandOption == 11 || bandOption == 63 || bandOption == 71 || bandOption == 75)
			{
				//form.elements["ssid"+wlan_idx].value = ssid_5g;
				var tmpstr=ssid_5g;
				if(ssid_5g.match("&quot;")!=null)
					tmpstr=ssid_5g.replace(/&quot;/g, "\"");
		
				if(ssid_2g.match("&#37;")!=null)
					tmpstr=tmpstr.replace(/&#37;/g, "%");
		
				if(ssid_2g.match("&#38;")!=null)
					tmpstr=tmpstr.replace(/&#38;/g, "&");
					
				if(ssid_5g.match("&#39;")!=null)
					tmpstr=tmpstr.replace(/&#39;/g, "'");
				
				if(ssid_5g.match("&#92;")!=null)
					tmpstr=tmpstr.replace(/&#92;/g, "\\");
		
				if(ssid_5g.match("&#62;")!=null)
					tmpstr=tmpstr.replace(/&#62;/g, ">");
		
				if(ssid_5g.match("&#60;")!=null)
					tmpstr=tmpstr.replace(/&#60;/g, "<");
				
				form.elements["ssid"+wlan_idx].value = tmpstr;
			}
		}
		function Set_onChangeBand(form, wlan_id, band, index){
			    var band;
			    var auto;
		 	    var txrate;
			var value;
			
			 var mode_selected=0;
			var Type_selected=0;
			var index_channelbound=0;
			var wlan_support_8812e=<% getIndex("wlan_support_8812e"); %>;
			
			value =band.options[index].value;
			if(value ==9 || value ==10 || value ==7 || value ==11 || value ==14 || value ==63 || value ==71 || value ==75 ||value==74){
		
				var controlsideband_idx=form.elements["controlsideband"+wlan_idx].selectedIndex;
				var wlan_controlsideband_value= form.elements["controlsideband"+wlan_idx].options[controlsideband_idx].value;
				wlan_controlsideband[wlan_idx] = wlan_controlsideband_value;
				document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>].length=0;
				showcontrolsideband_updated(document.wlanSetup, value, wlan_idx, <% getIndex("rf_used"); %>, index);	
			}
			
			showtxrate_updated(document.wlanSetup, value, wlan_idx, <% getIndex("rf_used"); %>);	
			
			var channelbound_idx=form.elements["channelbound"+wlan_idx].selectedIndex;
			var wlan_channelbound_value= form.elements["channelbound"+wlan_idx].options[channelbound_idx].value;
			wlan_channelbound[wlan_idx] = wlan_channelbound_value;
			document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].length=0;
			showchannelbound_updated(document.wlanSetup, value, wlan_idx, <% getIndex("rf_used"); %>);	
			
			updateChan_channebound(form, wlan_id);
			
		
			if(wlan_support_8812e==1 && ((value==11 || value ==63|| value ==71|| value==75 ||value==74) || (value==7 && index==1)))
				disableTextField(document.wlanSetup.elements["controlsideband"+wlan_id]);	
		}
		
		function ShowChannelInVxdMode()
		{
			var channel_drv = <%getInfo("channel_drv")%>;
			var repeaterState = "<%getInfo("repeaterState");%>";
			var isRepeaterDisplay =  <% getIndex("isRepeaterDisplay"); %> ;
			var sideband="<% getIndex("ControlSideBand"); %>";
			
			var i;
			if(channel_drv){
				if(repeaterState == "Connected"){
					if(isRepeaterDisplay){
						//if(document.wlanSetup.elements["chan"+wlan_idx].selectedIndex != 0){
							if(channel_drv != defaultChan[wlan_idx]){
								for(i=0; i<document.wlanSetup.elements["chan"+wlan_idx].length; i++){
									if(document.wlanSetup.elements["chan"+wlan_idx].options[i].value == channel_drv){
										document.wlanSetup.elements["chan"+wlan_idx].selectedIndex = i;
										break;
									}
								}
								if(i>= document.wlanSetup.elements["chan"+wlan_idx].length)
								{//change the side band
									if(sideband=="0")
										document.wlanSetup.elements["controlsideband"+ wlan_idx].selectedIndex=1;
									else
										document.wlanSetup.elements["controlsideband"+ wlan_idx].selectedIndex=0;
									updateChan_channebound(document.wlanSetup, wlan_idx);
									for(i=0; i<document.wlanSetup.elements["chan"+wlan_idx].length; i++){
										if(document.wlanSetup.elements["chan"+wlan_idx].options[i].value == channel_drv){
											document.wlanSetup.elements["chan"+wlan_idx].selectedIndex = i;
											break;
										}
									}
									
								}
							}			
						//}
					}
				}
			}
		}
		
		function LoadSetting()
		 {
		 	var switch_status='<%getIndex("autoWlanEnabled");%>';
			    if(switch_status){
			    	document.wlanSetup.autoWlanEnabled.checked=false;
			    	state_false();
			    }else{			    	
			    	document.wlanSetup.autoWlanEnabled.checked=true;
			    	state_true();
			    }
		 	var form = document.wlanSetup;
			var wlanband=<% getIndex("band"); %>; 
		
		
			var channelbound_idx=form.elements["channelbound"+wlan_idx].selectedIndex;
			var wlan_channelbound_value= form.elements["channelbound"+wlan_idx].options[channelbound_idx].value;
			wlan_channelbound[wlan_idx] = wlan_channelbound_value;
			document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].length=0;
			showchannelbound_updated(document.wlanSetup, (wlanband-1), wlan_idx, <% getIndex("rf_used"); %>);	
		 
			var init_bound = "<% getIndex("ChannelBonding"); %>";
		
			if (init_bound != "0")
				init_bound = "";
		
			var init_sideband="<% getIndex("ControlSideBand"); %>";
			if (init_sideband != "0")
				init_sideband = "";
		 
		 	if(init_bound=="0")
		 		document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].selectedIndex=0;
		 	else if(init_bound=="1")
		 		document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].selectedIndex=1;
			else if(init_bound=="2")
				document.wlanSetup.elements["channelbound"+<% getIndex("wlan_idx"); %>].selectedIndex=2;
		 		
		 	if(init_sideband=="0")
		 		document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>].selectedIndex=0;
		 	else
		 		document.wlanSetup.elements["controlsideband"+<% getIndex("wlan_idx"); %>].selectedIndex=1;	
		
			updateChan_channebound(document.wlanSetup, wlan_idx);		
		
			ShowChannelInVxdMode();	
		}
		
		function resetForm()
		{
			location=location; 
		}
		</SCRIPT>
	</head>
	<body onload="LoadSetting();initData();">
		 		<div class="main_content">
		 			<div class="wifi_content">
			 			<div class="wifiset">
			 				<form role="form" action="/boafrm/formWlanSetup" method="POST" name="wlanSetup">
			 				<INPUT type=hidden name=wps_clear_configure_by_reg<% getIndex("wlan_idx"); %> value=0>
							<INPUT type=hidden name=Band2G5GSupport value=<% getIndex("Band2G5GSupport"); %>>
							<INPUT type=hidden name=dsf_enable value=<% getIndex("dsf_enable"); %>>
							<INPUT type=hidden name=wlBandMode value=<% getIndex("wlanBand2G5GSelect"); %>>
							<INPUT type=hidden name="regdomain<% getIndex("wlan_idx");%>" value=<% getIndex("regDomain"); %>>
							<INPUT type=hidden name="countrystr<% getIndex("wlan_idx");%>" value=<% getInfo("country_str"); %>>
							<INPUT type=hidden name=wlan_support_8812e value=<% getIndex("wlan_support_8812e"); %>>
							<INPUT type=hidden name=wlan_support_8192f value=<% getIndex("wlan_support_8192f"); %>>
							<INPUT type=hidden name=wlan_support_ac2g value=<% getIndex("wlan_support_ac2g"); %>>
			 				<div class="top_wifiset">
			 					<div class="intell i18n" name="24g_5g_change_title_wifi"></div>		 					
				 				<div class="switch_check">
				 					<input type="checkbox" class="checkbox_switch" data-size="mini" name="" value="ON"/>
				 				</div>
						    </div>
						    <div class="wifiset_tips">
						    	<p class="i18n" name="tips_for_wifiset"></p>
						    </div>
			 				<hr />
			 				<div class="content_wifiset">
			 					<div class="leftset">	
			 						<%setWlanIDX ("wlan0");%>
			 							<div class="form-group title_24g"><span>2.4G</span></div>
			 							<div class="form-group" >
			 								<select name="band<% getIndex("wlan_idx"); %>" onChange="updateBand(document.wlanSetup, wlan_idx);Set_onChangeBand(document.wlanSetup, wlan_idx, document.wlanSetup.band<% getIndex("wlan_idx"); %>, document.wlanSetup.band<% getIndex("wlan_idx"); %>.selectedIndex);Set_SSIDbyBand(document.wlanSetup, wlan_idx,document.wlanSetup.band<% getIndex("wlan_idx"); %>, document.wlanSetup.band<% getIndex("wlan_idx"); %>.selectedIndex)">
										     	<SCRIPT>
													RFType[wlan_idx]= <% getIndex("RFType"); %>;
													APMode[wlan_idx]= <% getIndex("wlanMode"); %>;
													var val = <% getIndex("band"); %>;
													if (val > 0)
										    			bandIdx[wlan_idx]= val - 1;
													else
														bandIdx[wlan_idx]= val;
													bandIdxAP[wlan_idx]=bandIdx[wlan_idx];
													bandIdxClient[wlan_idx]=bandIdx[wlan_idx];
													showBand(document.wlanSetup, wlan_idx);
										     	</SCRIPT>
										 	</select>
			 							</div>
			 							<div class="form-group"><label class="i18n" name="ssid_wifset"></label><input class="form_input" id="ssid_forwifi" name="ssid<% getIndex("wlan_idx"); %>"  value="<% getInfo("ssid"); %>" placeholder=""/></div>
					 					<div class="form-group" style="display: none;">
					 						<select name="channelbound<% getIndex("wlan_idx"); %>" onChange="update_controlsideband(document.wlanSetup, wlan_idx); showtxrate_updated(document.wlanSetup,document.wlanSetup.band<% getIndex("wlan_idx"); %>.options[document.wlanSetup.band<% getIndex("wlan_idx"); %>.selectedIndex].value, wlan_idx, <% getIndex("rf_used"); %>)">
									     		<option value="0">20MHz</option>
												<option value="1">40MHz</option>
												<option value="2">80MHz</option>
												<option value="3">20/40MHz</option>
												<SCRIPT>
													use_40m = <% getIndex("ChannelBonding"); %>;
													document.wlanSetup.elements["channelbound" + <% getIndex("wlan_idx"); %>].selectedIndex=use_40m;
												</SCRIPT>
										 	</select>
					 					</div>
					 					<div class="form-group" style="display: none;">
					 						<select name="controlsideband<% getIndex("wlan_idx"); %>">

	 										</select>
					 					</div>
					 					<div class="form-group chenal_select">
					 						<label class="i18n" name="channel_select_wifiset"></label>
					 						<select  name="chan<% getIndex("wlan_idx"); %>" onChange="updateChan_selectedIndex(document.wlanSetup, wlan_idx);"> </select>
											    <SCRIPT>
												regDomain[wlan_idx] = <% getIndex("regDomain"); %>;
												defaultChan[wlan_idx] = <% getIndex("channel"); %>;
											
												wlan_channel[wlan_idx] = defaultChan[wlan_idx];
												updateChan(document.wlanSetup, wlan_idx);
											    </SCRIPT>	
					 						<span class="caret" style="position: relative;left: -40px;"></span>
					 					</div>
					 					<div class="form-group">
					 						<label class="i18n" name="encryption_wifiset"></label>
					 						<select name="" class="encryption_one" id="method" name="method<% getIndex("wlan_idx"); %>">
					 							<option value="0" class="i18n" name="disable_wifiset"></option>
					 							<option value="4">WPA2-PSK(AES)</option>
					 							<option value="6">WPA-PSK/WPA2-PSK</option>
					 						</select>	
					 						<span class="caret" style="position: relative;left: -40px;"></span>
					 					</div>
					 					<div class="form-group wpa2_aes_24g"><label class="i18n" name="encryption_key1_wifiset"></label><input class="form_input" type="password" name="pskValue<% getIndex("wlan_idx"); %>" id="wpapsk"/></div>
					 					<div class="form-group wpa_mixed_24g"><label class="i18n" name="encryption_key2_wifiset"></label><input class="form_input" type="password" name="wapiPskValue<% getIndex("wlan_idx"); %>" id="wapipsk" /></div>
			 					</div>
			 					<div class="rightset">
			 							<%setWlanIDX ("wlan1");%>
			 							<div class="form-group title_5g"><span>5G</span></div>
			 							<div class="form-group for_5g"><label class="i18n" name="ssid_5g_wifset"></label><input class="form_input" type="text" name=""  value="" placeholder=""/></div>
					 					<div class="form-group for_5g">
					 						<label class="i18n" name="channel_5g_select_wifiset"></label>
					 						<select name="" onChange="">
					 							<option value="" class="i18n" name="Auto_widiset"></option>
					 						</select>		
					 						<span class="caret" style="position: relative;left: -40px;"></span>
					 					</div>
					 					<div class="form-group for_5g">
					 						<label class="i18n" name="encryption_5g_wifiset"></label>
					 						<select name="" class="encryption_two">
					 							<option value="0" class="i18n" name="disable_wifiset"></option>
					 							<option value="4">WPA2-PSK(AES)</option>
					 							<option value="6">WPA-PSK/WPA2-PSK</option>					 			
					 						</select>	
					 						<span class="caret" style="position: relative;left: -40px;"></span>
					 					</div>
					 					<div class="form-group wpa2_aes_5g"><label class="i18n" name="encryption_5g_key1_wifiset"></label><input class="form_input" type="password" name=""/></div>
					 					<div class="form-group wpa_mixed_5g"><label class="i18n" name="encryption_5g_key2_wifiset"></label><input class="form_input" type="password" name=""/></div>
			 					</div>			 					
			 				</div>
			 				<div class="form-group form-group-btn">
			 					<% getInfo("apply_direct_comment_start");%>
			 					<button type="submit" value="Save & Apply" class="i18n" name="save_apply" onClick="return saveChanges_basic(document.wlanSetup, wlan_idx)"></button>
			 					<% getInfo("apply_direct_comment_end");%>
			 				</div>
			 			</form>
			 			</div>
		 			</div>
		 		</div>
		
		<script src="js/jquery.js"></script>
		<script src="js/bootstrap.js"></script>
		<script src="js/bootstrap-switch.min.js"></script>
		<!--<script src="js/jquery-1.9.1.min.js"></script>-->
	    <script src="js/jquery.cookie.js"></script>
	    <!-- 加载语言包文件 -->
	    <script src="js/jquery.i18n.properties.js"></script>
	    <script src="js/language.js"></script>
		<script type="text/javascript">
    	$(document).ready(function(){
        	$('.checkbox_switch').bootstrapSwitch({  //开关按钮
		        onText:"",  
		        offText:"",  
		        onColor:"success",  
		        offColor:"info",  
		        size : "mini",    // 设置控件大小,从小到大  (mini/small/normal/large)  
		        onSwitchChange:function(event,state){  
		            if(state==true){  
		               state_true();
		            }else{  		                
		               state_false(); 
		           }  
		      	}  
			})
			
			
        	$(".encryption_one").change(function(){
					var changevalue=$(this).val();
					if(changevalue==0){
						$(".wpa2_aes_24g,.wpa_mixed_24g,.wep_24g").css("display","none");
					}
					if(changevalue==4){
						$(".wpa_mixed_24g,.wep_24g").css("display","none");
						$(".wpa2_aes_24g").css("display","block");
					}
					if(changevalue==6){
						$(".wep_24g,.wpa2_aes_24g").css("display","none");
						$(".wpa_mixed_24g").css("display","block");
					}
				})
        	$(".encryption_two").change(function(){
					var changevalue=$(this).val()
					if(changevalue==0){
						$(".wpa2_aes_5g,.wep_5g,.wpa_mixed_5g").css("display","none");
					}
					if(changevalue==4){
						$(".wpa_mixed_5g,.wep_5g").css("display","none");
						$(".wpa2_aes_5g").css("display","block");
					}
					if(changevalue==6){
						$(".wep_5g,.wpa2_aes_5g").css("display","none");
						$(".wpa_mixed_5g").css("display","block");
					}
				})
	    	})
	    	
    		function state_true(){//state为true时页面的状态
				$(".title_24g,.title_5g,.for_5g,.wep_5g,.band_24g,.chenal_select").css("display","none");  
		        $(".wifiset_tips").css("display","block");		                
		        $(".leftset").css("float","none");
		        $(".leftset").css("margin-left","auto");
		        $(".leftset").css("margin-right","auto");
			}
			function state_false(){//state为false时页面的状态
				$(".title_24g,.title_5g,.for_5g,.chenal_select,.band_24g").css("display","block");  
		        $(".wifiset_tips").css("display","none"); 
		        $(".leftset").css("float","left");
		        $(".leftset").css("margin-left","none");
		        $(".leftset").css("margin-right","none");
			}
			
    	</script>
    	
	</body>
</html>
